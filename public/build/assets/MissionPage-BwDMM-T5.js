import{r as v,j as e,S as z,J as A}from"./app-CoH15XZe.js";import{C as F}from"./CitizenLayout-lHNe3MoP.js";import{C as b,b as R,d as V,a as _,B as N,I as E}from"./index-CJhcQlSm.js";import{S as C,a as D,b as k,c as S,d as l}from"./select-qH8VTgrm.js";import{a as $}from"./formatDate-DdkzSpcV.js";import{g as H,a as I}from"./missionStatusLabel-hBdcFGI7.js";import{B as J,T as O}from"./Footer-BKK-BSje.js";import{S as Q}from"./sliders-horizontal-BicjGVX4.js";import{R as W}from"./refresh-ccw-DWpdoJLu.js";import{S as U}from"./search-CtF3rUwp.js";import{M as Z}from"./map-pin-BEG_3O5b.js";import{C as q}from"./calendar-WlEt72KO.js";import{E as G}from"./eye-DNmXCH6Y.js";import"./index-DxlpFDeC.js";import"./createLucideIcon-CBxYhp_w.js";import"./heart-CN1gok8B.js";const K=({missions:c,myMissions:d,onViewDetails:w,provinces:y})=>{const[o,m]=v.useState("newest"),[i,M]=v.useState(""),[t,L]=v.useState({category:"semua",status:"semua",province:"semua",startDate:"",endDate:""}),B=v.useMemo(()=>{let a=c;if(i.trim()&&(a=a.filter(s=>{var r,n,h,p,j;return((r=s.title)==null?void 0:r.toLowerCase().includes(i.toLowerCase()))||((n=s.description)==null?void 0:n.toLowerCase().includes(i.toLowerCase()))||((p=(h=s.creator)==null?void 0:h.name)==null?void 0:p.toLowerCase().includes(i.toLowerCase()))||((j=s.address)==null?void 0:j.toLowerCase().includes(i.toLowerCase()))})),t.status!=="semua"){const r={open:"Dibuka","on-progress":"Sedang Berlangsung",completed:"Selesai",cancelled:"Dibatalkan","under-authority":"Misi Pihak Berwenang"}[t.status]||t.status;a=a.filter(n=>n.status===r)}return t.province!=="semua"&&(a=a.filter(s=>{var r;return((r=s.province)==null?void 0:r.name)===t.province})),t.startDate&&(a=a.filter(s=>{const r=new Date(s.created_at),n=new Date(t.startDate);return r>=n})),t.endDate&&(a=a.filter(s=>{const r=new Date(s.created_at),n=new Date(t.endDate);return r<=n})),[...a].sort((s,r)=>{switch(o){case"newest":return new Date(r.created_at).getTime()-new Date(s.created_at).getTime();case"oldest":return new Date(s.created_at).getTime()-new Date(r.created_at).getTime();case"title":return(s.title||"").localeCompare(r.title||"");case"status":return(s.status||"").localeCompare(r.status||"");default:return 0}})},[c,i,t,o]),g=(a,x)=>{L(s=>({...s,[a]:x}))},T=()=>{L({category:"semua",status:"semua",province:"semua",startDate:"",endDate:""}),M(""),m("newest")},u=i.trim()||t.status!=="semua"||t.province!=="semua"||t.startDate||t.endDate;return e.jsxs("div",{className:"mx-auto max-w-7xl px-4 py-8 sm:px-6 lg:px-8",children:[e.jsx("div",{className:"mb-8 flex flex-col items-start justify-between md:flex-row md:items-center",children:e.jsxs("div",{children:[e.jsx("h1",{className:"mb-2 text-3xl font-bold text-gray-900",children:d?"Misi yang Diikuti":"Daftar Misi"}),e.jsx("p",{className:"text-gray-600",children:"Temukan Misi dan jadilah bagian dalam aksi penyelamatan lingkungan"})]})}),e.jsxs("div",{className:"grid grid-cols-1 gap-8 lg:grid-cols-4",children:[e.jsx("div",{className:"lg:col-span-1",children:e.jsxs(b,{className:"sticky top-24",children:[e.jsx(R,{children:e.jsxs(V,{className:"flex items-center justify-between text-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Q,{size:20,className:"mr-2 text-emerald-600"}),"Filter Misi"]}),u&&e.jsx("span",{className:"rounded-full bg-emerald-100 px-2 py-1 text-xs text-emerald-600",children:"Aktif"})]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Status"}),e.jsxs(C,{value:t.status,onValueChange:a=>g("status",a),children:[e.jsx(D,{children:e.jsx(k,{placeholder:"Pilih status"})}),e.jsxs(S,{children:[e.jsx(l,{value:"semua",children:"Semua Status"}),e.jsx(l,{value:"open",children:"Dibuka"}),e.jsx(l,{value:"on-progress",children:"Sedang Berlangsung"}),e.jsx(l,{value:"completed",children:"Selesai"}),e.jsx(l,{value:"cancelled",children:"Dibatalkan"}),e.jsx(l,{value:"under-authority",children:"Misi Pihak Berwenang"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Provinsi"}),e.jsxs(C,{value:t.province,onValueChange:a=>g("province",a),children:[e.jsx(D,{children:e.jsx(k,{placeholder:"Pilih provinsi"})}),e.jsxs(S,{children:[e.jsx(l,{value:"semua",children:"Semua Provinsi"}),y.map(a=>e.jsx(l,{value:a.name,children:a.name},a.id))]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Tanggal Mulai"}),e.jsx("input",{type:"date",className:"w-full rounded-md border border-gray-200 px-2 py-2",value:t.startDate,onChange:a=>g("startDate",a.target.value)})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Tanggal Selesai"}),e.jsx("input",{type:"date",className:"w-full rounded border border-gray-300 px-2 py-2",value:t.endDate,onChange:a=>g("endDate",a.target.value),min:t.startDate})]}),e.jsx("div",{className:"space-y-2 pt-4",children:e.jsxs(N,{variant:"outline",className:"flex w-full items-center justify-center gap-2",onClick:T,disabled:!u,children:[e.jsx(W,{className:"h-4 w-4"}),"Reset Filter"]})})]})]})}),e.jsxs("div",{className:"lg:col-span-3",children:[e.jsxs("div",{className:"mb-6 flex flex-col items-start justify-between gap-4 sm:flex-row sm:items-center",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsxs(C,{value:o,onValueChange:m,children:[e.jsx(D,{className:"w-48",children:e.jsx(k,{placeholder:"Urutkan berdasarkan"})}),e.jsxs(S,{children:[e.jsx(l,{value:"newest",children:"Terbaru"}),e.jsx(l,{value:"oldest",children:"Terlama"}),e.jsx(l,{value:"title",children:"Judul A-Z"}),e.jsx(l,{value:"status",children:"Status"}),e.jsx(l,{value:"location",children:"Lokasi"})]})]})}),e.jsxs("div",{className:"relative w-full sm:w-64",children:[e.jsx(U,{className:"absolute left-3 top-3 h-4 w-4 text-gray-400"}),e.jsx(E,{placeholder:"Cari misi...",className:"pl-10",value:i,onChange:a=>M(a.target.value)})]})]}),B.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 gap-6 md:grid-cols-2 xl:grid-cols-3",children:B.map(a=>{var x,s,r,n,h,p,j,P;return e.jsxs(b,{className:"group cursor-pointer border-0 shadow-md transition-all duration-300 hover:-translate-y-1 hover:shadow-lg",onClick:()=>{var f;return w((f=a.report)==null?void 0:f.id)},children:[e.jsxs("div",{className:"relative overflow-hidden rounded-t-lg",children:[(n=(r=(s=(x=a.report)==null?void 0:x.media)==null?void 0:s[0])==null?void 0:r.media_type)!=null&&n.startsWith("video")?e.jsxs("div",{className:"relative h-48 w-full bg-black",children:[e.jsx("video",{className:"h-full w-full object-cover opacity-50",src:`/storage/${a.report.media[0].media_url}`,muted:!0,preload:"metadata"}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsx("div",{className:"rounded-full bg-white/80 p-2",children:e.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6 text-black",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M14.752 11.168l-5.197-3.03A1 1 0 008 9.03v5.94a1 1 0 001.555.832l5.197-3.03a1 1 0 000-1.664z"})})})})]}):e.jsx("img",{src:`/storage/${a.thumbnail_url}`,alt:a.title,className:"h-48 w-full object-cover transition-transform duration-300 group-hover:scale-105"}),e.jsx("div",{className:"absolute right-3 top-3",children:e.jsx(J,{className:I(a.status),children:H(a.status)})})]}),e.jsxs(_,{className:"p-4",children:[e.jsx("h3",{className:"mb-2 line-clamp-2 font-semibold text-gray-900 transition-colors group-hover:text-emerald-600",children:a.title}),e.jsx("p",{className:"mb-3 line-clamp-2 text-sm text-gray-600",children:a.description}),e.jsx("div",{className:"mb-3 flex items-center justify-between text-xs text-gray-500",children:e.jsxs("span",{children:["Oleh:"," ",(h=a.creator)==null?void 0:h.name]})}),e.jsxs("div",{className:"mb-3 flex items-center text-sm text-gray-500",children:[e.jsx(Z,{size:14,className:"mr-1"}),e.jsxs("span",{className:"truncate",children:[(p=a.district)==null?void 0:p.name,", ",(j=a.city)==null?void 0:j.name,","," ",(P=a.province)==null?void 0:P.name]})]}),e.jsx("div",{className:"mb-4 flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center text-sm text-gray-500",children:[e.jsx(q,{size:14,className:"mr-1"}),e.jsx("span",{children:$(a.created_at)})]})}),e.jsxs(N,{className:"mt-auto w-full bg-amber-500 transition-colors duration-200 hover:bg-amber-700",onClick:f=>{f.stopPropagation(),z.visit(`/report/${a.id}`)},children:[e.jsx(G,{size:16,className:"mr-2"}),"Lihat Detail"]})]})]},a.id)})}),e.jsx("div",{className:"mt-8 text-center",children:e.jsx(N,{variant:"outline",size:"lg",className:"min-w-32",children:"Muat Lebih Banyak"})})]}):e.jsx("div",{className:"flex w-full items-center justify-center",children:e.jsxs(b,{className:"w-full px-8 py-32 text-center",children:[e.jsx("div",{className:"mb-4 flex justify-center",children:e.jsx("div",{className:"rounded-full bg-gray-100 p-4",children:e.jsx(O,{size:32,className:"h-12 w-12 text-gray-400"})})}),e.jsx("h3",{className:"mb-2 text-lg font-semibold text-gray-900",children:u?"Tidak Ada Misi yang Sesuai":d?"Anda Belum Memiliki Misi":"Misi Belum Tersedia"}),e.jsx("p",{className:"text-sm text-gray-500",children:u?"Coba ubah filter atau kata kunci pencarian Anda.":d?"Anda belum memiliki misi. Silahkan mendaftar misi terlebih dahulu.":"Belum ada misi yang tersedia saat ini. Coba lagi nanti."}),u&&e.jsx(N,{variant:"outline",className:"mt-4",onClick:T,children:"Reset Filter"})]})})]})]})]})},he=()=>{var m;const{props:c}=A(),d=((m=c.missions)==null?void 0:m.data)||[],w=c.myMissions,y=c.provinces,o=i=>{i?z.visit(route("report.show",{id:i})):alert("Laporan tidak tersedia untuk misi ini.")};return e.jsx(F,{currentPage:"mission",children:e.jsx(K,{myMissions:w,missions:d,onViewDetails:o,provinces:y})})};export{he as default};
